# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Pyrogram Telegram Parser

## üèóÔ∏è –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    Telegram Network (MTProto)               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                         ‚îÇ
                         ‚îÇ (Pyrogram Client)
                         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                  Pyrogram TG Client                         ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ Handlers:                                             ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ @on_message(filters.channel)                       ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ @on_message(filters.private)                       ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                         ‚îÇ
                         ‚îÇ (Message objects)
                         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                   Message Handlers                          ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ Channel Handler:                                    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç registry.is_active(username)           ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ –ò–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è                       ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ –í—ã–∑—ã–≤–∞–µ—Ç db.insert_message(payload)              ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ Private Handler:                                    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç registry.enabled                       ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ –ò–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ DM                              ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ –í—ã–∑—ã–≤–∞–µ—Ç db.insert_message(payload)              ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                         ‚îÇ
                         ‚îÇ (Insert operations)
                         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                   SQLite Database Module                    ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ insert_message(payload) ‚Üí row_id                      ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç payload –≤ SQL –∑–Ω–∞—á–µ–Ω–∏—è                ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ –í—Å—Ç–∞–≤–ª—è–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü—É messages                      ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç ID —Å—Ç—Ä–æ–∫–∏                              ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ init()                                                ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ –°–æ–∑–¥–∞—ë—Ç —Ç–∞–±–ª–∏—Ü—É messages                          ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ –°–æ–∑–¥–∞—ë—Ç –∏–Ω–¥–µ–∫—Å—ã                                   ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                         ‚îÇ
                         ‚îÇ (File I/O)
                         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                  parser.db (SQLite —Ñ–∞–π–ª)                    ‚îÇ
‚îÇ                  ‚úì –õ–æ–∫–∞–ª—å–Ω–æ –Ω–∞ –¥–∏—Å–∫–µ                        ‚îÇ
‚îÇ                  ‚úì –ù–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç OpenClaw                   ‚îÇ
‚îÇ                  ‚úì –î–æ—Å—Ç—É–ø–Ω–∞ —á–µ—Ä–µ–∑ SQL –∑–∞–ø—Ä–æ—Å—ã               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                         ‚ñ≤
                         ‚îÇ (SQL queries)
                         ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              OpenClaw (—á–∏—Ç–∞–µ—Ç –Ω–∞–ø—Ä—è–º—É—é)                      ‚îÇ
‚îÇ  ‚Ä¢ SELECT * FROM messages WHERE ...                         ‚îÇ
‚îÇ  ‚Ä¢ –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ                                       ‚îÇ
‚îÇ  ‚Ä¢ –í—ã–ø–æ–ª–Ω—è–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏                                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üì¶ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### 1. config.py
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ó–∞–≥—Ä—É–∑–∫–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–∑ `.env` —Ñ–∞–π–ª–∞
- –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–≤ main.py)
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

**–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã:**
```python
TELEGRAM_API_ID          # int
TELEGRAM_API_HASH        # str
TELEGRAM_SESSION_NAME    # str
DB_PATH                  # str (–ø—É—Ç—å –∫ SQLite –ë–î)
LOG_LEVEL               # str (DEBUG, INFO, WARNING, ERROR)
LOG_FILE                # str (path) –∏–ª–∏ –ø—É—Å—Ç–æ
```

### 2. logger.py
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –°–æ–∑–¥–∞—Ç—å –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–≥–µ—Ä "parser"
- –î–æ–±–∞–≤–∏—Ç—å StreamHandler –¥–ª—è –∫–æ–Ω—Å–æ–ª–∏
- –î–æ–±–∞–≤–∏—Ç—å RotatingFileHandler –¥–ª—è —Ñ–∞–π–ª–∞ (–µ—Å–ª–∏ LOG_FILE)
- –ü—Ä–∏–º–µ–Ω–∏—Ç—å –µ–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤

**–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è:**
```python
setup_logging() -> logging.Logger
```

**–§–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤:**
```
[%(asctime)s] %(levelname)s %(name)s: %(message)s
```

### 3. channel_registry.py
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –•—Ä–∞–Ω–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤ –≤ –ø–∞–º—è—Ç–∏
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å/–∑–∞–≥—Ä—É–∂–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–∑ `channels.json`
- –£–ø—Ä–∞–≤–ª—è—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–º —Ñ–ª–∞–≥–æ–º –≤–∫–ª—é—á–µ–Ω–∏—è/–æ—Ç–∫–ª—é—á–µ–Ω–∏—è

**–ö–ª–∞—Å—Å ChannelRegistry:**
```python
class ChannelRegistry:
    enabled: bool              # –ì–ª–æ–±–∞–ª—å–Ω–æ –≤–∫–ª—é—á–µ–Ω–∞ –ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞
    channels: set[str]         # –ú–Ω–æ–∂–µ—Å—Ç–≤–æ username –∫–∞–Ω–∞–ª–æ–≤ (@name)

    def add(username: str) -> bool
    def remove(username: str) -> bool
    def is_active(username: str) -> bool
    def enable() -> bool
    def disable() -> bool
```

**–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å:**
- –§–æ—Ä–º–∞—Ç: `channels.json` —Å JSON —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

### 4. db.py (–ù–û–í–´–ô –ú–û–î–£–õ–¨)
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å SQLite –ë–î

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ë–î –∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã
- –í—Å—Ç–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü—É
- –£–ø—Ä–∞–≤–ª—è—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º
- –°–æ–∑–¥–∞–≤–∞—Ç—å –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–ö–ª–∞—Å—Å Database:**
```python
class Database:
    db_path: str
    conn: aiosqlite.Connection | None

    async def init() -> None              # –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã
    async def insert_message(payload: dict) -> int  # –í—Å—Ç–∞–≤–∏—Ç—å –∏ –≤–µ—Ä–Ω—É—Ç—å ID
    async def close() -> None             # –ó–∞–∫—Ä—ã—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
```

**–¢–∞–±–ª–∏—Ü–∞ messages:**
```sql
id               INTEGER PRIMARY KEY AUTOINCREMENT
source           TEXT NOT NULL        -- 'channel' –∏–ª–∏ 'private'
channel_id       INTEGER             -- ID –∫–∞–Ω–∞–ª–∞ (–¥–ª—è channel)
channel_username TEXT                -- Username –∫–∞–Ω–∞–ª–∞ (–¥–ª—è channel)
channel_title    TEXT                -- –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞ (–¥–ª—è channel)
chat_id          INTEGER             -- ID —á–∞—Ç–∞ (–¥–ª—è private)
message_id       INTEGER NOT NULL    -- ID —Å–æ–æ–±—â–µ–Ω–∏—è –≤ Telegram
text             TEXT                -- –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
timestamp        REAL                -- Unix timestamp
from_user_id     INTEGER             -- ID –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
from_username    TEXT                -- Username –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
from_first_name  TEXT                -- –ò–º—è –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
created_at       DATETIME DEFAULT CURRENT_TIMESTAMP
```

**–ò–Ω–¥–µ–∫—Å—ã:**
- `idx_messages_timestamp` - –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
- `idx_messages_channel` - –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ –∫–∞–Ω–∞–ª—É

### 5. tg_client.py
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Pyrogram –∫–ª–∏–µ–Ω—Ç–∞ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –°–æ–∑–¥–∞—Ç—å Pyrogram Client —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∏–∑ config
- –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ –∫–∞–Ω–∞–ª–æ–≤
- –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

**–§—É–Ω–∫—Ü–∏–∏:**
```python
def build_client() -> Client
def register_handlers(app: Client, db: Database, registry: ChannelRegistry) -> None
```

**–§–∏–ª—å—Ç—Ä—ã Pyrogram:**
- `filters.channel` - —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ –∫–∞–Ω–∞–ª–æ–≤
- `filters.private` - –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

### 6. handlers/channel_handler.py
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ –∫–∞–Ω–∞–ª–æ–≤

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –∞–∫—Ç–∏–≤–µ–Ω –ª–∏ –∫–∞–Ω–∞–ª –≤ —Ä–µ–µ—Å—Ç—Ä–µ (`registry.is_active`)
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ username –∫–∞–Ω–∞–ª–∞
- –ò–∑–≤–ª–µ—á—å –¥–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (—Ç–µ–∫—Å—Ç, –∞–≤—Ç–æ—Ä, –≤—Ä–µ–º—è)
- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –ë–î

**–õ–æ–≥–∏–∫–∞:**
```
1. –ü–æ–ª—É—á–∏—Ç—å –æ–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç Pyrogram
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å message.chat.username
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å registry.is_active(username)
4. –ï—Å–ª–∏ inactive ‚Üí return (–ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å)
5. –ò–∑–≤–ª–µ—á—å: id, title, message_id, text, timestamp, from_user
6. –í—ã–∑–≤–∞—Ç—å db.insert_message({...payload..., "source": "channel"})
```

### 7. handlers/private_handler.py
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±—Ä–∞–±–æ—Ç–∫–∞ –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (DM)

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–π —Ñ–ª–∞–≥ –≤–∫–ª—é—á–µ–Ω–∏—è (`registry.enabled`)
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
- –ò–∑–≤–ª–µ—á—å –¥–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –ë–î

**–õ–æ–≥–∏–∫–∞:**
```
1. –ü–æ–ª—É—á–∏—Ç—å –æ–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç Pyrogram
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å registry.enabled
3. –ï—Å–ª–∏ disabled ‚Üí return (–ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å)
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å message.from_user
5. –ò–∑–≤–ª–µ—á—å: chat_id, message_id, text, timestamp, from_user
6. –í—ã–∑–≤–∞—Ç—å db.insert_message({...payload..., "source": "private"})
```

### 8. main.py
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
- –°–æ–∑–¥–∞—Ç—å –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å Database
- –°–æ–∑–¥–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å Pyrogram Client
- –£–ø—Ä–∞–≤–ª—è—Ç—å graceful shutdown

**–û—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫:**
```
1. setup_logging()
2. –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å TELEGRAM_API_ID –∏ TELEGRAM_API_HASH
3. –°–æ–∑–¥–∞—Ç—å registry = ChannelRegistry()
4. –°–æ–∑–¥–∞—Ç—å db = Database(DB_PATH)
5. await db.init()  # –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã
6. app = build_client()
7. register_handlers(app, db, registry)
8. await app.start()
9. await idle()
10. Cleanup: app.stop(), db.close()
```

## üîÑ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

### Event Loop –≥–ª–∞–≤–Ω—ã—Ö –∑–∞–¥–∞—á:

```python
asyncio.run(main())
  ‚îÇ
  ‚îú‚îÄ db.init()                          # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
  ‚îÇ   ‚îî‚îÄ CREATE TABLE messages (...)
  ‚îÇ
  ‚îú‚îÄ app.start()                        # Pyrogram –∫–ª–∏–µ–Ω—Ç
  ‚îÇ   ‚îî‚îÄ –°–ª—É—à–∞–µ—Ç Telegram —Å–æ–æ–±—â–µ–Ω–∏—è
  ‚îÇ      ‚îú‚îÄ on_channel_message()
  ‚îÇ      ‚îÇ   ‚îî‚îÄ handle_channel_message()
  ‚îÇ      ‚îÇ       ‚îî‚îÄ db.insert_message(payload)
  ‚îÇ      ‚îÇ           ‚îî‚îÄ INSERT INTO messages (...)
  ‚îÇ      ‚îÇ
  ‚îÇ      ‚îî‚îÄ on_private_message()
  ‚îÇ          ‚îî‚îÄ handle_private_message()
  ‚îÇ              ‚îî‚îÄ db.insert_message(payload)
  ‚îÇ                  ‚îî‚îÄ INSERT INTO messages (...)
  ‚îÇ
  ‚îî‚îÄ idle()                             # –î–µ—Ä–∂–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –∂–∏–≤—ã–º
```

## üìä –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

### –í—Ö–æ–¥—è—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ Telegram –∫–∞–Ω–∞–ª–∞:

```
Telegram Network
  ‚îÇ
  ‚îî‚îÄ Pyrogram Client
      ‚îÇ
      ‚îî‚îÄ @on_message(filters.channel)
          ‚îÇ
          ‚îî‚îÄ handle_channel_message()
              ‚îÇ
              ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å registry.is_active(channel)
              ‚îÇ
              ‚îú‚îÄ –ò–∑–≤–ª–µ—á—å –¥–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
              ‚îÇ
              ‚îî‚îÄ db.insert_message({
                  "source": "channel",
                  "channel_id": ...,
                  "channel_username": ...,
                  "message_id": ...,
                  "text": ...,
                  "timestamp": ...,
                  "from_user": {...}
              })
                  ‚îÇ
                  ‚îî‚îÄ Database.insert_message()
                      ‚îÇ
                      ‚îî‚îÄ INSERT INTO messages (...)
                          ‚îÇ
                          ‚îî‚îÄ parser.db (SQLite —Ñ–∞–π–ª)
```

### –í—Ö–æ–¥—è—â–µ–µ –ª–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:

```
Telegram Network
  ‚îÇ
  ‚îî‚îÄ Pyrogram Client
      ‚îÇ
      ‚îî‚îÄ @on_message(filters.private)
          ‚îÇ
          ‚îî‚îÄ handle_private_message()
              ‚îÇ
              ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å registry.enabled
              ‚îÇ
              ‚îú‚îÄ –ò–∑–≤–ª–µ—á—å –¥–∞–Ω–Ω—ã–µ DM
              ‚îÇ
              ‚îî‚îÄ db.insert_message({
                  "source": "private",
                  "chat_id": ...,
                  "message_id": ...,
                  "text": ...,
                  "timestamp": ...,
                  "from_user": {...}
              })
                  ‚îÇ
                  ‚îî‚îÄ Database.insert_message()
                      ‚îÇ
                      ‚îî‚îÄ INSERT INTO messages (...)
                          ‚îÇ
                          ‚îî‚îÄ parser.db
```

### OpenClaw —á–∏—Ç–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ:

```
OpenClaw (–ª—é–±–æ–µ –≤—Ä–µ–º—è)
  ‚îÇ
  ‚îî‚îÄ SQL –∑–∞–ø—Ä–æ—Å –∫ parser.db
      ‚îÇ
      ‚îî‚îÄ SELECT * FROM messages 
         WHERE channel_username = '@news'
         ORDER BY timestamp DESC
         ‚îÇ
         ‚îî‚îÄ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
             ‚îú‚îÄ –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ
             ‚îú‚îÄ –í—ã–ø–æ–ª–Ω—è–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏
             ‚îî‚îÄ –û–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:

1. **–õ–æ–∫–∞–ª—å–Ω–∞—è –ë–î:**
   - –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Ö—Ä–∞–Ω—è—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ SQLite
   - –ù–µ—Ç –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ —Å–µ—Ç—å
   - –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ —á–µ—Ä–µ–∑ —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É

2. **–ó–∞—â–∏—Ç–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
   - `.env` —Ñ–∞–π–ª –Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è (–≤ `.gitignore`)
   - –ü–∞—Ä–æ–ª–∏ Telegram –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä
   - API –∫–ª—é—á–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –±–µ–∑–æ–ø–∞—Å–Ω–æ

3. **–í–∞–ª–∏–¥–∞—Ü–∏—è:**
   - –í—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–∞—Ä—Å—è—Ç—Å—è —Å error handling
   - SQL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç prepared statements
   - –ò—Å–∫–ª—é—á–µ–Ω–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
python -m py_compile config.py db.py logger.py channel_registry.py tg_client.py handlers/*.py main.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–ø–æ—Ä—Ç–æ–≤
python -c "import config; import db; import logger; import channel_registry; print('OK')"

# –ó–∞–ø—É—Å–∫ —Å DEBUG –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
LOG_LEVEL=DEBUG python main.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ë–î
sqlite3 parser.db "SELECT COUNT(*) as message_count FROM messages;"
```

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:

1. **Async/await**: –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞
2. **–ò–Ω–¥–µ–∫—Å—ã**: –ò–Ω–¥–µ–∫—Å—ã –Ω–∞ timestamp –∏ channel_username –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
3. **Registry –≤ –ø–∞–º—è—Ç–∏**: –ë—ã—Å—Ç—Ä—ã–π O(1) –¥–æ—Å—Ç—É–ø –∫ –∫–∞–Ω–∞–ª–∞–º
4. **–†–æ—Ç–∏—Ä—É—é—â–∏–µ –ª–æ–≥–∏**: –ù–µ —Ä–∞—Å—Ç—É—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ

### –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:

- **–ú–Ω–æ–∂–µ—Å—Ç–≤–æ –∫–∞–Ω–∞–ª–æ–≤**: set[str] –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è —Ö–æ—Ä–æ—à–æ
- **–ß–∞—Å—Ç—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è**: Async –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –Ω–∞–≥—Ä—É–∑–∫–æ–π
- **–ú–Ω–æ–∂–µ—Å—Ç–≤–æ DM**: –ö–∞–∂–¥—ã–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
- **–†–∞–∑–º–µ—Ä –ë–î**: SQLite –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –º–∏–ª–ª–∏–æ–Ω–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –º–æ–¥—É–ª—è–º:

```python
logger = logging.getLogger("parser.db")              # –¥–ª—è db.py
logger = logging.getLogger("parser.handler.channel") # –¥–ª—è channel_handler.py
logger = logging.getLogger("parser.handler.private") # –¥–ª—è private_handler.py
```

### –¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –≤—ã–∑–æ–≤–æ–≤:

```env
LOG_LEVEL=DEBUG    # –í—Å–µ –¥–µ—Ç–∞–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏–π —Å –ë–î –∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
```

### –ò–Ω—Å–ø–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è:

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –ë–î
sqlite3 parser.db ".schema"
sqlite3 parser.db "SELECT COUNT(*) FROM messages;"
sqlite3 parser.db "SELECT * FROM messages LIMIT 5;"

# –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
grep -E "^[^#]" .env
```

## üìö –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π –≤ –ë–î:

1. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å SQL –≤ `db.py`:
```python
ALTER TABLE messages ADD COLUMN new_field TEXT;
```

2. –û–±–Ω–æ–≤–∏—Ç—å payload –≤ handlers:
```python
payload = {
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è ...
    "new_field": extract_new_field(message)
}
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π:

1. –°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –≤ `handlers/new_handler.py`
2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ `tg_client.py`:
```python
@app.on_message(filters.new_filter)
async def on_new_message(client, message):
    await handle_new_message(client, message, db, registry)
```

3. –í—Å—Ç–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ `db.insert_message()`

## üîó –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏

```
main.py
  ‚îú‚îÄ‚îÄ config.py              (–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è)
  ‚îú‚îÄ‚îÄ logger.py              (setup_logging)
  ‚îú‚îÄ‚îÄ db.py                  (Database –∫–ª–∞—Å—Å) ‚Üê –ù–û–í–´–ô –ú–û–î–£–õ–¨
  ‚îú‚îÄ‚îÄ tg_client.py           (build_client, register_handlers)
  ‚îÇ   ‚îî‚îÄ‚îÄ handlers/
  ‚îÇ       ‚îú‚îÄ‚îÄ channel_handler.py
  ‚îÇ       ‚îî‚îÄ‚îÄ private_handler.py
  ‚îî‚îÄ‚îÄ channel_registry.py    (ChannelRegistry)

db.py
  ‚îî‚îÄ‚îÄ (no internal deps)

channel_registry.py
  ‚îî‚îÄ‚îÄ (no internal deps)

tg_client.py
  ‚îî‚îÄ‚îÄ handlers/*

config.py
  ‚îî‚îÄ‚îÄ (external: dotenv)
```

## üéØ –ú–∏–≥—Ä–∞—Ü–∏—è –æ—Ç WebSocket-–≤–µ—Ä—Å–∏–∏

### –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:

**–ë—ã–ª–æ (WebSocket –≤–µ—Ä—Å–∏—è):**
- `gateway_client.py` - WebSocket –∫–ª–∏–µ–Ω—Ç
- `command_handler.py` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç `websockets>=12.0`
- –¢—Ä–µ–±–æ–≤–∞–ª —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ OpenClaw Gateway

**–°—Ç–∞–ª–æ (SQLite –≤–µ—Ä—Å–∏—è):**
- `db.py` - SQLite –º–æ–¥—É–ª—å
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –Ω–∞ `aiosqlite>=0.19`
- –†–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
- OpenClaw —á–∏—Ç–∞–µ—Ç –ë–î –Ω–∞–ø—Ä—è–º—É—é

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:

‚úÖ –ü–∞—Ä—Å–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–Ω–æ–º–Ω–æ
‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç OpenClaw Gateway –¥–ª—è —Ä–∞–±–æ—Ç—ã
‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
‚úÖ OpenClaw –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ SQL
‚úÖ –ü—Ä–æ—Å—Ç–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏
‚úÖ –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å REST API –¥–ª—è –¥–æ—Å—Ç—É–ø–∞

## üìä –ü—Ä–∏–º–µ—Ä—ã SQL –∑–∞–ø—Ä–æ—Å–æ–≤

```sql
-- –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ –∫–∞–Ω–∞–ª–∞
SELECT * FROM messages WHERE channel_username = '@news';

-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ 10 —Å–æ–æ–±—â–µ–Ω–∏–π
SELECT * FROM messages ORDER BY timestamp DESC LIMIT 10;

-- –°–æ–æ–±—â–µ–Ω–∏—è –∑–∞ —Å–µ–≥–æ–¥–Ω—è
SELECT * FROM messages 
WHERE DATE(created_at) = DATE('now');

-- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ –∫–∞–Ω–∞–ª–∞–º
SELECT channel_username, COUNT(*) 
FROM messages 
WHERE source = 'channel'
GROUP BY channel_username
ORDER BY COUNT(*) DESC;

-- –°–∞–º—ã–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –∞–≤—Ç–æ—Ä—ã
SELECT from_username, COUNT(*) 
FROM messages 
WHERE from_username IS NOT NULL
GROUP BY from_username
ORDER BY COUNT(*) DESC LIMIT 10;

-- –ü–æ–∏—Å–∫ –ø–æ —Ç–µ–∫—Å—Ç—É
SELECT * FROM messages 
WHERE text LIKE '%keyword%'
ORDER BY timestamp DESC;
```
